# Dependencies Review Workflow
#
# This workflow performs automated dependency reviews and security scanning for the repository.
# It runs on multiple triggers to ensure dependencies are regularly checked and reviewed.
#
# Triggers:
#   - schedule: Runs daily at midnight (00:00 UTC) via cron job
#   - pull_request: Runs when PRs are opened/updated against the main branch
#   - workflow_dispatch: Allows manual triggering from the Actions tab
#
# Permissions:
#   The workflow requires minimal permissions at the top level (empty set),
#   but the dependencies job specifically needs:
#     - contents: write - To update dependency files if needed
#     - pull-requests: write - To create/update PRs with dependency updates
#     - issues: write - To create/update issues for dependency vulnerabilities
#     - security-events: read - To access security scanning results
#
# Jobs:
#   dependencies:
#     Uses a reusable workflow from the same repository to perform dependency
#     review tasks. The workflow is referenced from the feat/dependency-workflow
#     branch and requires a GitHub token for authentication.
#
# Secrets:
#   - GITHUB_TOKEN: Automatically provided by GitHub Actions for authentication
#

name: Dependencies review ⚡️
run-name: Dependencies review ⚡️

on:
  schedule:
    - cron: "0 0 * * *"

  pull_request:
    branches: ["main"]

  workflow_dispatch:

permissions: {}

jobs:
  dependencies:
    permissions:
      contents: write
      pull-requests: write
      issues: write
      security-events: read

    uses: ministryofjustice/devsecops-actions/.github/workflows/_dependency.yml@feat/dependency-workflow
    secrets:
      token: ${{ secrets.GITHUB_TOKEN }}
