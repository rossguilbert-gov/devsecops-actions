# Dependencies Review Workflow
#
# This reusable workflow orchestrates dependency scanning and review processes
# for the repository. It runs on a scheduled basis, on pull requests to main,
# and can be manually triggered.
#
# Triggers:
#   - schedule: Runs daily at midnight (00:00 UTC)
#   - pull_request: Executes when PRs are opened/updated against main branch
#   - workflow_dispatch: Allows manual execution from GitHub Actions UI
#
# Permissions:
#   - contents: write - Required to update repository files
#   - pull-requests: write - Required to comment on and manage PRs
#   - issues: write - Required to create/update issues for vulnerabilities
#   - security-events: read - Required to access security scanning results
#
# Configuration:
#   - policy-mode: enforce - Strict mode that enforces dependency policies
#   - token: GitHub token for authentication with repository operations
#
# Dependencies:
#   - Calls the reusable _dependency.yml workflow from the feat/dependency-workflow branch
#

name: Dependencies review ⚡️
run-name: Dependencies review ⚡️

on:
  schedule:
    - cron: "0 0 * * *"

  pull_request:
    branches: ["main"]

  workflow_dispatch:

permissions: {}

jobs:
  dependencies:
    permissions:
      contents: write
      pull-requests: write
      issues: write
      security-events: read

    name: Dependencies⚡️
    uses: ministryofjustice/devsecops-actions/.github/workflows/_dependency.yml@feat/dependency-workflow
    secrets:
      token: ${{ secrets.GITHUB_TOKEN }}
