# =====================================================
# Syft Configuration â€“ Polyglot / CI / GitHub Actions
# =====================================================

# -------------------------
# Logging
# -------------------------
log:
  quiet: false
  level: warn

# -------------------------
# Output (SBOMs)
# -------------------------
output:
  - "cyclonedx-json=sca-sbom.cdx.json"

format:
  cyclonedx-json:
    pretty: false

# -------------------------
# Package behavior
# -------------------------
package:
  search-indexed-archives: true
  search-unindexed-archives: false
  exclude-binary-overlap-by-ownership: true

# -------------------------
# License handling
# -------------------------
license:
  # include license text only when unknown (CI-friendly)
  content: unknown

  # minimum % match to consider a license valid
  coverage: 75

# -------------------------
# File metadata
# -------------------------
file:
  metadata:
    # include only files owned by packages (fast + clean)
    selection: owned-by-package
    digests:
      - sha512

  content:
    # skip large files (>250 KB)
    skip-files-above-size: 256000

# -------------------------
# Relationships
# -------------------------
relationships:
  package-file-ownership: true
  package-file-ownership-overlap: true

# -------------------------
# Compliance rules
# -------------------------
compliance:
  # drop unnamed packages (noise)
  missing-name: drop

  # stub missing versions (keeps graph intact)
  missing-version: stub

# -------------------------
# Unknown handling
# -------------------------
unknowns:
  remove-when-packages-defined: true
  executables-without-packages: true
  unexpanded-archives: true

# -------------------------
# Exclusions
# -------------------------
exclude:
  - "**/.git/**"
  - "**/node_modules/**"
  - "**/vendor/**"
  - "**/dist/**"
  - "**/build/**"
  - "**/target/**"
  - "**/.venv/**"
  - "**/__pycache__/**"

# -------------------------
# Performance
# -------------------------
parallelism: 0 # auto-scale based on CPU

cache:
  dir: "~/.cache/syft"
  ttl: "7d"

# -------------------------
# Enrichment (OFF by default)
# Enable only for release scans
# -------------------------
enrich: []

# -------------------------
# Language-specific settings
# -------------------------
java:
  use-network: false
  use-maven-local-repository: true
  maven-local-repository-dir: "~/.m2/repository"
  resolve-transitive-dependencies: false

javascript:
  include-dev-dependencies: false
  search-remote-licenses: false

python:
  search-remote-licenses: false
  guess-unpinned-requirements: false

golang:
  search-remote-licenses: false
  local-mod-cache-dir: "~/go/pkg/mod"
  main-module-version:
    from-ld-flags: true
    from-build-settings: true

dotnet:
  dep-packages-must-claim-dll: true
  propagate-dll-claims-to-parents: true

# -------------------------
# Registry / container safety
# -------------------------
registry:
  insecure-skip-tls-verify: false
  insecure-use-http: false

# -------------------------
# Source metadata (optional)
# -------------------------
source:
  name: ""
  version: ""
  supplier: ""
