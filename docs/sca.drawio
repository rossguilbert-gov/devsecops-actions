<mxfile host="65bd71144e">
    <diagram name="SCA Composite Action" id="github-flow">
        <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1000" pageHeight="800" background="#0d1117" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                
                <!-- Title -->
                <mxCell id="title" value="Software Composition Analysis (SCA) Action" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="100" y="40" width="800" height="40" as="geometry"/>
                </mxCell>
                
                <mxCell id="subtitle" value="ministryofjustice/devsecops-actions/sca" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="100" y="75" width="800" height="25" as="geometry"/>
                </mxCell>
                
                <!-- Start Circle -->
                <mxCell id="start" value="START" style="ellipse;whiteSpace=wrap;html=1;fillColor=#238636;strokeColor=#2ea043;fontColor=#ffffff;fontSize=12;fontStyle=1;fontFamily=Segoe UI;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="450" y="130" width="100" height="60" as="geometry"/>
                </mxCell>
                
                <!-- Arrow 1 -->
                <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="start" target="step1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Step 1: Checkout Repository -->
                <mxCell id="step1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1c2d41;strokeColor=#388bfd;strokeWidth=2;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="200" y="230" width="600" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step1-icon" value="ðŸ“¦" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="220" y="245" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step1-title" value="Checkout Repository" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="245" width="480" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="step1-desc" value="actions/checkout@v6.0.1&lt;br&gt;Clones repository code and prepares workspace for scanning" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="275" width="480" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Arrow 2 -->
                <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="step1" target="step2">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Step 2: Dependency Review -->
                <mxCell id="step2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#341a00;strokeColor=#9e6a03;strokeWidth=2;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="200" y="370" width="600" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step2-icon" value="ðŸ”" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="220" y="385" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step2-title" value="Dependency Review" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="385" width="480" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="step2-desc" value="actions/dependency-review-action@v4.8.3&lt;br&gt;Scans dependencies for vulnerabilities, license issues, and security risks" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="415" width="480" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Arrow 3 with conditional -->
                <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="step2" target="decision">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Decision Diamond -->
                <mxCell id="decision" value="renovate == 'true' ?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#21262d;strokeColor=#30363d;strokeWidth=2;fontColor=#c9d1d9;fontSize=13;fontStyle=1;fontFamily=Segoe UI;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="400" y="510" width="200" height="100" as="geometry"/>
                </mxCell>
                
                <!-- Arrow Yes -->
                <mxCell id="arrowYes" value="YES" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#3fb950;strokeWidth=2;endArrow=block;endFill=1;fontColor=#3fb950;fontSize=12;fontStyle=1;fontFamily=Segoe UI;" edge="1" parent="1" source="decision" target="step3">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Step 3: Renovate Bot -->
                <mxCell id="step3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0d1e1a;strokeColor=#2ea043;strokeWidth=2;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="200" y="650" width="300" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step3-icon" value="ðŸ¤–" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="220" y="665" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step3-title" value="Renovate Bot" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="665" width="180" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="step3-desc" value="renovatebot/github-action@v44.2.1&lt;br&gt;Automated dependency updates" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="695" width="180" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Arrow No -->
                <mxCell id="arrowNo" value="NO" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#f85149;strokeWidth=2;endArrow=block;endFill=1;fontColor=#f85149;fontSize=12;fontStyle=1;fontFamily=Segoe UI;" edge="1" parent="1" source="decision" target="skip">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Skip Step -->
                <mxCell id="skip" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2c0b0e;strokeColor=#da3633;strokeWidth=2;shadow=1;dashed=1;" vertex="1" parent="1">
                    <mxGeometry x="550" y="650" width="250" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="skip-icon" value="â­ï¸" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="570" y="665" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="skip-title" value="Skip Renovate" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="640" y="665" width="150" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="skip-desc" value="Renovate disabled&lt;br&gt;No automated updates" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="640" y="695" width="150" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Merge paths -->
                <mxCell id="merge1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=none;endFill=0;" edge="1" parent="1" source="step3" target="merge-point">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="350" y="780" as="sourcePoint"/>
                        <mxPoint x="500" y="780" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                
                <mxCell id="merge2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=none;endFill=0;" edge="1" parent="1" source="skip" target="merge-point">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="675" y="780" as="sourcePoint"/>
                        <mxPoint x="500" y="780" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                
                <mxCell id="merge-point" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#8b949e;strokeColor=#8b949e;" vertex="1" parent="1">
                    <mxGeometry x="490" y="775" width="20" height="20" as="geometry"/>
                </mxCell>
                
                <!-- Arrow to secrets step -->
                <mxCell id="arrow-secrets" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="merge-point" target="step4">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Step 4: Secret Scanning -->
                <mxCell id="step4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#3d1100;strokeColor=#d29922;strokeWidth=2;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="200" y="830" width="600" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step4-icon" value="ðŸ”‘" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="220" y="845" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step4-title" value="Secret Scanning" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="845" width="480" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="step4-desc" value="ghcr.io/ministryofjustice/devsecops-hooks:v1.3.0&lt;br&gt;Scans codebase for exposed secrets and credentials using Docker container" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="875" width="480" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Arrow to trufflehog -->
                <mxCell id="arrow-trufflehog" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="step4" target="step5">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Step 5: Trufflehog Scan -->
                <mxCell id="step5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#321a41;strokeColor=#a371f7;strokeWidth=2;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="200" y="970" width="600" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step5-icon" value="ðŸ·" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="220" y="985" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step5-title" value="Trufflehog Secret Scanning" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="985" width="480" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="step5-desc" value="trufflesecurity/trufflehog:3.92.4&lt;br&gt;Advanced secret detection and scanning, uploads findings as artifact" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="1015" width="480" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Arrow to codeql -->
                <mxCell id="arrow-codeql" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="step5" target="step6">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- Step 6: CodeQL Analysis -->
                <mxCell id="step6" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1a2b1c;strokeColor=#3fb950;strokeWidth=2;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="200" y="1110" width="600" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="step6-icon" value="âš™ï¸" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=32;" vertex="1" parent="1">
                    <mxGeometry x="220" y="1125" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="step6-title" value="CodeQL Security Analysis" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="1125" width="480" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="step6-desc" value="github/codeql-action@v4.31.9&lt;br&gt;Code scanning for security vulnerabilities, uploads results to Code Scanning" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=12;fontColor=#8b949e;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="300" y="1155" width="480" height="45" as="geometry"/>
                </mxCell>
                
                <!-- Arrow to end -->
                <mxCell id="arrow-end" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#8b949e;strokeWidth=2;endArrow=block;endFill=1;" edge="1" parent="1" source="step6" target="end">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                
                <!-- End Circle -->
                <mxCell id="end" value="END" style="ellipse;whiteSpace=wrap;html=1;fillColor=#484f58;strokeColor=#6e7681;fontColor=#ffffff;fontSize=12;fontStyle=1;fontFamily=Segoe UI;shadow=1;" vertex="1" parent="1">
                    <mxGeometry x="450" y="1250" width="100" height="60" as="geometry"/>
                </mxCell>
                
                <!-- Legend Box -->
                <mxCell id="legend-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#161b22;strokeColor=#30363d;strokeWidth=1;" vertex="1" parent="1">
                    <mxGeometry x="850" y="130" width="140" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="850" y="135" width="140" height="25" as="geometry"/>
                </mxCell>
                
                <!-- Legend items -->
                <mxCell id="legend1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#1c2d41;strokeColor=#388bfd;strokeWidth=2;" vertex="1" parent="1">
                    <mxGeometry x="860" y="170" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend1-text" value="Process Step" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="895" y="170" width="90" height="20" as="geometry"/>
                </mxCell>
                
                <mxCell id="legend2" value="" style="rhombus;whiteSpace=wrap;html=1;fillColor=#21262d;strokeColor=#30363d;strokeWidth=2;" vertex="1" parent="1">
                    <mxGeometry x="860" y="200" width="30" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="legend2-text" value="Condition" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="895" y="202" width="90" height="20" as="geometry"/>
                </mxCell>
                
                <mxCell id="legend3" value="" style="ellipse;whiteSpace=wrap;html=1;fillColor=#238636;strokeColor=#2ea043;" vertex="1" parent="1">
                    <mxGeometry x="860" y="235" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend3-text" value="Start/End" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="895" y="235" width="90" height="20" as="geometry"/>
                </mxCell>
                
                <mxCell id="legend4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2c0b0e;strokeColor=#da3633;strokeWidth=2;dashed=1;" vertex="1" parent="1">
                    <mxGeometry x="860" y="265" width="30" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend4-text" value="Skipped Step" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontColor=#c9d1d9;fontFamily=Segoe UI;" vertex="1" parent="1">
                    <mxGeometry x="895" y="265" width="90" height="20" as="geometry"/>
                </mxCell>
                
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>